<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#DD0303">
    <title>{% block title %}Hackversity - Digital Fortress{% endblock %}</title>
    {% load static %}
    <meta name="csrf-token" content="{{ csrf_token }}">
    
    <!-- Preload critical fonts -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Main Stylesheet -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    
    <!-- Preloader Stylesheet -->
    <link href="{% static 'css/preloader.css' %}" rel="stylesheet">
    
    <!-- Inline Preloader Start - Executes immediately -->
    <script>
        // Create preloader HTML immediately when head is processed
        document.write(`
            <div class="preloader" id="cyber-preloader" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 30%, #2d1212 70%, #1a0a0a 100%); display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 1;">
                <div class="security-grid"></div>
                <div class="security-icons">
                    <div class="security-icon">üõ°Ô∏è</div>
                    <div class="security-icon">üîê</div>
                    <div class="security-icon">üîí</div>
                    <div class="security-icon">‚ö°</div>
                    <div class="security-icon">üîë</div>
                </div>
                <div class="preloader-logo">
                    <h1 class="preloader-title" style="font-family: Inter, sans-serif; font-size: 3rem; color: #DD0303; margin-bottom: 0.5rem; text-shadow: 0 0 20px rgba(221, 3, 3, 0.5);">Hackversity</h1>
                    <p class="preloader-subtitle" style="font-family: Inter, sans-serif; font-size: 1rem; color: #00f5ff; opacity: 0.8;">Digital Fortress</p>
                </div>
                <div class="security-scanner">
                    <div class="scanner-ring"></div>
                    <div class="scanner-ring"></div>
                    <div class="scanner-ring"></div>
                    <div class="scanner-center"></div>
                </div>
                <div class="progress-container" style="width: 300px; height: 4px; background: rgba(255, 255, 255, 0.1); border-radius: 2px; margin: 2rem 0 1rem 0;">
                    <div class="progress-bar" id="progress-bar" style="height: 100%; background: linear-gradient(90deg, #DD0303, #00f5ff, #ffd700); border-radius: 2px; width: 0%; transition: width 0.3s ease;"></div>
                </div>
                <div class="preloader-status" id="preloader-status" style="font-family: Inter, sans-serif; font-size: 0.9rem; color: #00f5ff; text-align: center; margin-top: 1rem; opacity: 0.8;">
                    Initializing Security Protocols...
                </div>
            </div>
        `);
        
        // Simple progress animation
        setTimeout(() => {
            const progressBar = document.getElementById('progress-bar');
            if (progressBar) {
                let width = 0;
                const interval = setInterval(() => {
                    width += Math.random() * 5 + 2;
                    if (width > 100) width = 100;
                    progressBar.style.width = width + '%';
                    if (width >= 100) clearInterval(interval);
                }, 100);
            }
        }, 500);
    </script>
    
    <!-- Preloader JavaScript - Load early to catch page loading state -->
    <script src="{% static 'js/preloader.js' %}"></script>
    
    <!-- Favicon and App Icons -->
    {% load static safe_static %}
    {% safe_static_or_default 'images/favicon.ico' 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231a1a2e"/><text x="50" y="65" font-family="Arial,sans-serif" font-size="60" font-weight="bold" fill="%2300f5ff" text-anchor="middle">H</text></svg>' as favicon_url %}
    {% if favicon_url %}
        <link rel="icon" type="image/x-icon" href="{{ favicon_url }}">
    {% endif %}
    <link rel="apple-touch-icon" href="{% static 'images/apple-touch-icon.png' %}">
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <div class="logo">
                <div class="logo-image">
                    
                    <span class="logo-text-red">Hackversity</span>
                    <span class="logo-subtitle">A University For Ethical Hackers</span>
                </div>
            </div>
            <ul class="nav-links">
                {% if user.is_authenticated %}
                    <li><a href="/chat/">Home</a></li>
                    <li><a href="/chat/?force_chat=1">Chat</a></li>
                    <li><a href="/accounts/profile/">Profile</a></li>
                    <li class="user-avatar-container">
                        <div class="user-avatar">
                            {% if user.get_avatar_url %}
                                <img src="{{ user.get_avatar_url }}" alt="{{ user.get_full_name|default:user.username }}" class="avatar-image">
                            {% else %}
                                <div class="avatar-initials">{{ user.get_initials }}</div>
                            {% endif %}
                        </div>
                        <span class="username-text">{{ user.get_full_name|default:user.username }}</span>
                    </li>
                    <li><a href="/accounts/logout/">Logout</a></li>
                {% else %}
                    <li><a href="/chat/">Home</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="/accounts/login/">Login</a></li>
                    <li><a href="/accounts/signup/">Sign Up</a></li>
                {% endif %}
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <div class="bg-grid"></div>
        <div class="floating-elements">
            <div class="floating-element"></div>
            <div class="floating-element"></div>
            <div class="floating-element"></div>
            <div class="floating-element"></div>
            <div class="floating-element"></div>
        </div>
        
        {% comment %}
        Alert notifications removed per user request
        {% if messages %}
            <div class="alert-container">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        {% endcomment %}

        {% block content %}
        {% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <span class="logo-text-red">Hackversity</span>
                        <span class="footer-tagline">A University For Ethical Hackers</span>
                    </div>
                    <p class="footer-description">
                        Empowering the next generation of cybersecurity professionals through 
                        advanced AI-powered learning and hands-on experience.
                    </p>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-title">Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="{% url 'chat:home' %}">Home</a></li>
                        {% if user.is_authenticated %}
                            <li><a href="{% url 'chat:home' %}?force_chat=1">AI Chat</a></li>
                            <li><a href="{% url 'accounts:profile' %}">Profile</a></li>
                        {% else %}
                            <li><a href="{% url 'login' %}">Login</a></li>
                            <li><a href="{% url 'accounts:signup' %}">Sign Up</a></li>
                        {% endif %}
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-title">Resources</h4>
                    <ul class="footer-links">
                        <li><a href="#">Documentation</a></li>
                        <li><a href="#">Cybersecurity Blog</a></li>
                        <li><a href="#">Learning Paths</a></li>
                        <li><a href="#">Community</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-title">Connect</h4>
                    <div class="footer-social">
                        <a href="#" class="social-link" aria-label="GitHub">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="Discord">
                            <i class="fab fa-discord"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="LinkedIn">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </div>
                    <div class="footer-newsletter">
                        <h5>Stay Updated</h5>
                        <form class="newsletter-form">
                            <input type="email" placeholder="Enter your email" class="newsletter-input">
                            <button type="submit" class="newsletter-btn">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <p>&copy; 2025 Hackversity. All rights reserved.</p>
                    <div class="footer-bottom-links">
                        <a href="#">Privacy Policy</a>
                        <a href="#">Terms of Service</a>
                        <a href="#">Cookie Policy</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Add search input focus effects and smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Add parallax effect to floating elements
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const parallax = document.querySelectorAll('.floating-element');
            const speed = 0.5;

            parallax.forEach(element => {
                const yPos = -(scrolled * speed);
                element.style.transform = `translateY(${yPos}px)`;
            });
        });

        // Add interactive hover effects
        document.querySelectorAll('.btn-primary, .btn-secondary').forEach(button => {
            button.addEventListener('mouseenter', function(e) {
                const ripple = document.createElement('span');
                const rect = e.target.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.width = ripple.style.height = size + 'px';
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';
                ripple.classList.add('ripple');
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });
    </script>
    
    <!-- Responsive Enhancements -->
    <script src="{% static 'js/responsive.js' %}"></script>
    
    <!-- Hide preloader when page is fully loaded -->
    <script>
        function hidePreloader() {
            const preloader = document.getElementById('cyber-preloader');
            if (preloader) {
                setTimeout(() => {
                    preloader.style.opacity = '0';
                    preloader.style.visibility = 'hidden';
                    setTimeout(() => {
                        if (preloader.parentNode) {
                            preloader.parentNode.removeChild(preloader);
                        }
                    }, 800);
                }, 1500); // Show for at least 1.5 seconds
            }
        }
        
        // Hide preloader when everything is loaded
        if (document.readyState === 'complete') {
            hidePreloader();
        } else {
            window.addEventListener('load', hidePreloader);
        }
        
        // Failsafe: hide after 5 seconds no matter what
        setTimeout(hidePreloader, 5000);
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>